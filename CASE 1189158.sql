SELECT  TOP 500 PM00200.VENDORID AS VENDORID, PM00200.VENDNAME AS VENDNAME, PM00200.VNDCHKNM AS VNDCHKNM, PM00200.VNDCLSID AS VNDCLSID, PM00200.ADDRESS1 AS ADDRESS1, PM00200.ADDRESS2 AS ADDRESS2, PM00200.ADDRESS3 AS ADDRESS3, PM00200.CITY AS CITY, PM00200.STATE AS STATE, PM00200.ZIPCODE AS ZIPCODE, PM00200.USERDEF1 AS USERDEF1, PM00200.VENDORID AS vdfVendorID, '''' AS Empty2, '''' AS Empty1, '''' AS Empty3, CASE WHEN PM00200.CURNCYID = '''' THEN MC40000.FUNLCURR ELSE PM00200.CURNCYID END AS RETURN_CURNCYID, VENDNAME AS vdfVendorDesc, ISNULL(PM00300.SHIPMTHD,PM00200.SHIPMTHD) AS SHIPMTHD, SHMTHDSC AS SHMTHDSC, PM00200.PYMTRMID AS PYMTRMID, PM00200.PYMTRMID AS vdfPaymentTermID, PM00300.ADRSCODE AS edfVendorAddrID, PM00300.ADRSCODE AS vdfAddressIDVendor, ISNULL(PM00300.TAXSCHID,PM00200.TAXSCHID) AS vdfTaxScheduleID, APTaxTypeDtl.idfDescription AS vdfTaxTypeID
FROM 
        PM00200 (NOLOCK)
        CROSS JOIN MC40000 (NOLOCK)
        LEFT OUTER JOIN APTaxTypeDtl WITH (NOLOCK) ON APTaxTypeDtl.idfAPTaxTypeKey = PM00200.TEN99TYPE AND APTaxTypeDtl.udfNumericField01 = PM00200.TEN99BOXNUMBER
        LEFT OUTER JOIN dbo.APVendor WITH (NOLOCK) ON APVendor.idfVendorID = PM00200.VENDORID
        
        INNER JOIN WCListDtl ClassList(NOLOCK) ON ClassList.idfCodeID = PM00200.VNDCLSID AND ClassList.idfWCListHdrKey = '357' 
		LEFT OUTER JOIN PM00300 WITH (NOLOCK) ON ((PM00300.ADRSCODE = PM00200.VADCDTRO AND '3'='3') OR (PM00300.ADRSCODE = PM00200.VADCDPAD AND '3'<>'3')) AND PM00200.VENDORID = PM00300.VENDORID 
		LEFT OUTER JOIN SY03000   (NOLOCK) ON ISNULL(PM00300.SHIPMTHD,PM00200.SHIPMTHD)  = SY03000.SHIPMTHD 
		CROSS JOIN (SELECT 3 AS vdfValue) RQTypeKey
        LEFT OUTER JOIN dbo.IV00106 U (NOLOCK) ON U.ITEMNMBR=I.ITEMNMBR AND U.UOFM = CASE   WHEN ISNULL(IV00103.PRCHSUOM,'') ='' THEN CASE WHEN Sy.idfFlagRQUOMFromSales = 0 OR I.ITEMTYPE <> 1 OR I.SELNGUOM = '''' OR RQTypeKey.vdfValue = 4 THEN I.PRCHSUOM ELSE I.SELNGUOM END ELSE IV00103.PRCHSUOM END
       
WHERE 
VENDSTTS <> 2
 ORDER BY 1,2,3,4,5,6,7,8,9,10,11

 